<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#1a1a2e" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <title>Guitar Shred Program</title>
  <link rel="manifest" href="manifest.json" />
  <style>
    :root {
      --bg: #0f0f1a;
      --surface: #1a1a2e;
      --surface2: #22223b;
      --accent: #e63946;
      --accent2: #f4a261;
      --text: #edf2f4;
      --text2: #a8b2c1;
      --border: #2d2d4e;
      --success: #2ec4b6;
      --radius: 12px;
      --radius-sm: 8px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
    }

    /* ‚îÄ‚îÄ TOP BAR ‚îÄ‚îÄ */
    .topbar {
      background: var(--surface);
      border-bottom: 1px solid var(--border);
      padding: 12px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .topbar h1 { font-size: 1rem; font-weight: 700; letter-spacing: 0.5px; }
    .topbar span { color: var(--accent); }
    .menu-btn { background: none; border: none; color: var(--text); font-size: 1.4rem; cursor: pointer; padding: 4px; }

    /* ‚îÄ‚îÄ NAV TABS ‚îÄ‚îÄ */
    .nav-tabs {
      display: flex;
      background: var(--surface);
      border-bottom: 1px solid var(--border);
      overflow-x: auto;
      scrollbar-width: none;
    }
    .nav-tabs::-webkit-scrollbar { display: none; }
    .nav-tab {
      flex: 0 0 auto;
      padding: 10px 16px;
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--text2);
      cursor: pointer;
      border-bottom: 2px solid transparent;
      white-space: nowrap;
      transition: all 0.2s;
    }
    .nav-tab.active { color: var(--accent); border-bottom-color: var(--accent); }

    /* ‚îÄ‚îÄ MAIN CONTENT ‚îÄ‚îÄ */
    main { flex: 1; overflow-y: auto; padding: 16px; padding-bottom: 80px; }

    /* ‚îÄ‚îÄ CARDS ‚îÄ‚îÄ */
    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 16px;
      margin-bottom: 12px;
    }
    .card-title { font-size: 1rem; font-weight: 700; margin-bottom: 4px; }
    .card-sub { font-size: 0.78rem; color: var(--text2); margin-bottom: 10px; }

    /* ‚îÄ‚îÄ EXERCISE CARD ‚îÄ‚îÄ */
    .ex-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      margin-bottom: 14px;
      overflow: hidden;
    }
    .ex-header {
      padding: 14px 16px 10px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 8px;
    }
    .ex-header-left { flex: 1; }
    .ex-id { font-size: 0.7rem; color: var(--accent); font-weight: 700; letter-spacing: 1px; text-transform: uppercase; }
    .ex-title { font-size: 0.95rem; font-weight: 700; margin: 2px 0 4px; }
    .ex-technique {
      display: inline-block;
      font-size: 0.7rem;
      padding: 2px 8px;
      border-radius: 20px;
      background: var(--surface2);
      color: var(--text2);
      font-weight: 600;
    }
    .ex-chevron { color: var(--text2); font-size: 1.2rem; transition: transform 0.3s; flex-shrink: 0; margin-top: 2px; }
    .ex-card.open .ex-chevron { transform: rotate(180deg); }

    .ex-body { display: none; padding: 0 16px 16px; }
    .ex-card.open .ex-body { display: block; }

    /* ‚îÄ‚îÄ TABLATURE ‚îÄ‚îÄ */
    .tab-container {
      background: #0a0a14;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 12px 10px;
      margin: 12px 0;
      overflow-x: auto;
    }
    .tab-line {
      font-family: 'Courier New', monospace;
      font-size: 0.78rem;
      line-height: 1.8;
      color: #c9d1d9;
      white-space: pre;
    }
    .tab-line .string-name { color: var(--accent2); font-weight: 700; }

    /* ‚îÄ‚îÄ BPM & CONTROLS ‚îÄ‚îÄ */
    .bpm-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 12px 0;
      flex-wrap: wrap;
    }
    .bpm-badge {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 6px 12px;
      font-size: 0.85rem;
      font-weight: 700;
      color: var(--accent2);
    }
    .bpm-label { font-size: 0.72rem; color: var(--text2); }

    /* ‚îÄ‚îÄ BUTTONS ‚îÄ‚îÄ */
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 10px 18px;
      border-radius: var(--radius-sm);
      font-size: 0.85rem;
      font-weight: 700;
      cursor: pointer;
      border: none;
      transition: all 0.15s;
      user-select: none;
    }
    .btn-primary { background: var(--accent); color: white; }
    .btn-primary:active { background: #c1121f; }
    .btn-secondary { background: var(--surface2); color: var(--text); border: 1px solid var(--border); }
    .btn-secondary:active { background: var(--border); }
    .btn-success { background: var(--success); color: #0f0f1a; }
    .btn-icon { padding: 10px; border-radius: 50%; }
    .btn:disabled { opacity: 0.4; cursor: not-allowed; }

    .play-row { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; margin-top: 10px; }

    /* ‚îÄ‚îÄ TIP BOX ‚îÄ‚îÄ */
    .tip-box {
      background: rgba(230, 57, 70, 0.08);
      border-left: 3px solid var(--accent);
      border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
      padding: 10px 12px;
      font-size: 0.8rem;
      color: var(--text2);
      margin-top: 10px;
      line-height: 1.5;
    }
    .tip-box strong { color: var(--accent); }

    /* ‚îÄ‚îÄ METRONOME ‚îÄ‚îÄ */
    .metronome-card {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--surface);
      border-top: 1px solid var(--border);
      padding: 10px 16px;
      z-index: 200;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .metro-bpm-display {
      font-size: 1.3rem;
      font-weight: 800;
      color: var(--accent2);
      min-width: 52px;
      text-align: center;
    }
    .metro-controls { display: flex; align-items: center; gap: 6px; flex: 1; }
    .metro-btn { background: var(--surface2); border: 1px solid var(--border); color: var(--text); border-radius: var(--radius-sm); padding: 6px 12px; font-size: 1rem; font-weight: 700; cursor: pointer; }
    .metro-btn:active { background: var(--border); }
    .metro-toggle { background: var(--accent); border: none; color: white; border-radius: 50%; width: 40px; height: 40px; font-size: 1rem; cursor: pointer; display: flex; align-items: center; justify-content: center; }
    .metro-toggle.on { background: var(--success); }
    .metro-pulse {
      width: 10px; height: 10px; border-radius: 50%;
      background: var(--border);
      transition: background 0.05s;
      flex-shrink: 0;
    }
    .metro-pulse.beat { background: var(--accent); }
    .timer-display {
      font-size: 0.85rem;
      font-weight: 700;
      color: var(--text2);
      min-width: 42px;
      text-align: right;
    }

    /* ‚îÄ‚îÄ PRINCIPLES PAGE ‚îÄ‚îÄ */
    .principle-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-left: 4px solid var(--accent);
      border-radius: var(--radius);
      padding: 14px 16px;
      margin-bottom: 10px;
    }
    .principle-title { font-size: 0.85rem; font-weight: 800; color: var(--accent); margin-bottom: 4px; }
    .principle-text { font-size: 0.82rem; color: var(--text2); line-height: 1.55; }

    /* ‚îÄ‚îÄ MONTH HEADER ‚îÄ‚îÄ */
    .month-header {
      background: linear-gradient(135deg, var(--surface) 0%, var(--surface2) 100%);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 16px;
      margin-bottom: 14px;
    }
    .month-num { font-size: 0.72rem; color: var(--accent); font-weight: 700; letter-spacing: 2px; text-transform: uppercase; }
    .month-title { font-size: 1.1rem; font-weight: 800; margin: 4px 0 6px; }
    .month-obj { font-size: 0.8rem; color: var(--text2); line-height: 1.4; }

    .week-label {
      font-size: 0.78rem;
      font-weight: 700;
      color: var(--accent2);
      letter-spacing: 0.5px;
      margin: 16px 0 8px;
      text-transform: uppercase;
    }

    /* ‚îÄ‚îÄ BACKING TRACKS ‚îÄ‚îÄ */
    .bt-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 14px 16px;
      margin-bottom: 10px;
    }
    .bt-id { font-size: 0.7rem; color: var(--success); font-weight: 700; letter-spacing: 1px; }
    .bt-title { font-size: 0.95rem; font-weight: 700; margin: 4px 0 8px; }
    .bt-chords { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 8px; }
    .bt-chord {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 4px 10px;
      font-size: 0.82rem;
      font-weight: 700;
      color: var(--accent2);
    }
    .bt-info { font-size: 0.78rem; color: var(--text2); line-height: 1.6; }
    .bt-search {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-top: 10px;
      padding: 8px 14px;
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      font-size: 0.78rem;
      color: var(--text2);
      cursor: pointer;
      text-decoration: none;
    }

    /* ‚îÄ‚îÄ OVERVIEW TABLE ‚îÄ‚îÄ */
    .overview-table { width: 100%; border-collapse: collapse; font-size: 0.78rem; }
    .overview-table th { background: var(--surface2); color: var(--accent); padding: 8px 10px; text-align: left; font-size: 0.72rem; letter-spacing: 0.5px; }
    .overview-table td { padding: 8px 10px; border-bottom: 1px solid var(--border); color: var(--text2); }
    .overview-table tr:last-child td { border-bottom: none; }

    /* ‚îÄ‚îÄ LOADING STATE ‚îÄ‚îÄ */
    .loading {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.82rem;
      color: var(--text2);
      padding: 4px 0;
    }
    .spinner {
      width: 14px; height: 14px;
      border: 2px solid var(--border);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 0.6s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* ‚îÄ‚îÄ PAGE TRANSITIONS ‚îÄ‚îÄ */
    .page { display: none; }
    .page.active { display: block; }

    /* ‚îÄ‚îÄ PROGRESS ‚îÄ‚îÄ */
    .progress-bar {
      height: 4px;
      background: var(--surface2);
      border-radius: 2px;
      margin-top: 8px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background: var(--accent);
      border-radius: 2px;
      transition: width 0.3s;
    }

    /* ‚îÄ‚îÄ SESSION TIMER ‚îÄ‚îÄ */
    .session-bar {
      background: var(--surface2);
      border-radius: var(--radius-sm);
      padding: 8px 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
      font-size: 0.82rem;
    }
    .session-time { font-weight: 800; color: var(--success); font-size: 1rem; }
  </style>
</head>
<body>

<div class="topbar">
  <h1>üé∏ <span>Shred</span> Program</h1>
  <div style="display:flex;gap:8px;align-items:center">
    <span id="audioStatus" class="loading" style="display:none">
      <span class="spinner"></span> <span>Caricamento audio‚Ä¶</span>
    </span>
  </div>
</div>

<nav class="nav-tabs" id="navTabs">
  <div class="nav-tab active" data-page="home">Home</div>
  <div class="nav-tab" data-page="m1">Mese 1</div>
  <div class="nav-tab" data-page="m2">Mese 2</div>
  <div class="nav-tab" data-page="m3">Mese 3</div>
  <div class="nav-tab" data-page="m4">Mese 4</div>
  <div class="nav-tab" data-page="melodic">Melodici</div>
  <div class="nav-tab" data-page="backing">Backing</div>
</nav>

<main id="mainContent">
  <!-- HOME PAGE -->
  <div class="page active" id="page-home">
    <div class="card" style="background:linear-gradient(135deg,#1a1a2e,#22223b);border-color:#e63946">
      <div style="font-size:0.72rem;color:var(--accent);font-weight:700;letter-spacing:2px;text-transform:uppercase;margin-bottom:6px">Guitar Shred Program</div>
      <div style="font-size:1.2rem;font-weight:800;margin-bottom:4px">4 Mesi verso la Meccanica Perfetta</div>
      <div style="font-size:0.82rem;color:var(--text2)">Obiettivo: Another Day ‚Äì Dream Theater</div>
    </div>

    <div class="session-bar">
      <span>‚è± Sessione corrente</span>
      <span class="session-time" id="sessionTimer">00:00</span>
      <button class="btn btn-secondary" style="padding:4px 10px;font-size:0.75rem" id="sessionToggle">Start</button>
    </div>

    <div style="font-size:0.82rem;font-weight:700;color:var(--text2);margin-bottom:10px;text-transform:uppercase;letter-spacing:0.5px">Struttura Sessione</div>
    <div id="sessionStructure"></div>

    <div style="font-size:0.82rem;font-weight:700;color:var(--text2);margin:16px 0 10px;text-transform:uppercase;letter-spacing:0.5px">5 Regole Fondamentali</div>
    <div id="principlesContainer"></div>

    <div style="font-size:0.82rem;font-weight:700;color:var(--text2);margin:16px 0 10px;text-transform:uppercase;letter-spacing:0.5px">Panoramica Programma</div>
    <div class="card" style="padding:0;overflow:hidden">
      <table class="overview-table">
        <thead><tr><th>Mese</th><th>Settimane</th><th>Tecniche</th><th>BPM</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>1‚Äì4</td><td>Alternate Picking, Legato</td><td>70‚Üí80</td></tr>
          <tr><td>2</td><td>5‚Äì8</td><td>Vibrato, Bend, Sweep 3C</td><td>80 pick / 50‚Äì70 sweep</td></tr>
          <tr><td>3</td><td>9‚Äì12</td><td>String Skipping, Velocit√†</td><td>100‚Äì110</td></tr>
          <tr><td>4</td><td>13‚Äì16</td><td>Frasi combinate, Another Day</td><td>110‚Äì120</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- MONTH PAGES (generati da JS) -->
  <div class="page" id="page-m1"></div>
  <div class="page" id="page-m2"></div>
  <div class="page" id="page-m3"></div>
  <div class="page" id="page-m4"></div>
  <div class="page" id="page-melodic"></div>
  <div class="page" id="page-backing"></div>
</main>

<!-- METRONOME BAR -->
<div class="metronome-card">
  <div class="metro-pulse" id="metroPulse"></div>
  <div class="metro-bpm-display" id="metroBpmDisplay">80</div>
  <div class="metro-controls">
    <button class="metro-btn" id="metroDec">‚àí</button>
    <button class="metro-btn" id="metroInc">+</button>
    <button class="metro-btn" id="metroTap">TAP</button>
  </div>
  <button class="metro-toggle" id="metroToggle">‚ñ∂</button>
  <div class="timer-display" id="timerDisplay">--:--</div>
</div>

<script src="data.js"></script>
<script src="app.js"></script>
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js').catch(() => {});
  }
</script>
</body>
</html>
